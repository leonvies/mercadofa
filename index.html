<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MercadoF√£ - v1.1 - Goi√°s</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM (Stable UMD) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @keyframes scan {
            0%, 100% { top: 0%; height: 2px; }
            50% { top: 100%; height: 2px; }
        }
        .animate-scan {
            position: absolute;
            width: 100%;
            background: #4f46e5;
            box-shadow: 0 0 20px #4f46e5, 0 0 40px #4f46e5;
            animation: scan 2s infinite ease-in-out;
        }
        .scale-up-animation {
            animation: scaleUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes scaleUp {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        ::-webkit-scrollbar { display: none; }
        body { -webkit-tap-highlight-color: transparent; font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel" data-presets="env,react">
        const { useState, useEffect, useMemo } = React;
        const APP_VERSION = "1.1.0";

        // Componente de √çcone Base
        const IconBase = ({ children, size = 24, ...props }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                {...props}
            >
                {children}
            </svg>
        );

        // √çcones SVG Inline
        const Icons = {
            ChevronRight: (p) => <IconBase {...p}><path d="m9 18 6-6-6-6"/></IconBase>,
            QrCode: (p) => <IconBase {...p}><rect width="5" height="5" x="3" y="3" rx="1"/><rect width="5" height="5" x="16" y="3" rx="1"/><rect width="5" height="5" x="3" y="16" rx="1"/><path d="M21 16h-3a2 2 0 0 0-2 2v3"/><path d="M12 7v3"/><path d="M7 12h3"/><path d="M12 21v-5"/><path d="M16 12h5"/></IconBase>,
            Ticket: (p) => <IconBase {...p}><path d="M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M13 5v2"/><path d="M13 17v2"/><path d="M13 11v2"/></IconBase>,
            Wallet: (p) => <IconBase {...p}><path d="M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1"/><path d="M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4"/></IconBase>,
            ShoppingBag: (p) => <IconBase {...p}><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></IconBase>,
            Bell: (p) => <IconBase {...p}><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></IconBase>,
            Map: (p) => <IconBase {...p}><path d="M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z"/><path d="M15 5.764v15"/><path d="M9 3.236v15"/></IconBase>,
            List: (p) => <IconBase {...p}><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></IconBase>,
            Sun: (p) => <IconBase {...p}><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/></IconBase>,
            Moon: (p) => <IconBase {...p}><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></IconBase>,
            Trophy: (p) => <IconBase {...p}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></IconBase>,
            MapPin: (p) => <IconBase {...p}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></IconBase>,
            Star: (p) => <IconBase {...p}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></IconBase>,
            History: (p) => <IconBase {...p}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></IconBase>,
            CheckCircle: (p) => <IconBase {...p}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="m9 11 3 3L22 4"/></IconBase>,
            ArrowRight: (p) => <IconBase {...p}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></IconBase>
        };

        // Dados Regionalizados (Goi√¢nia e An√°polis)
        const MOCK_MERCHANTS = [
            { id: 'm1', name: 'Super Bar√£o - Bueno', city: 'Goi√¢nia', distance: '0.9 km', rule: '1 bilhete / R$ 5', has_bonus: true, bonus_text: 'Dobro de Bilhetes hoje!', address: 'Av. T-63, Setor Bueno', rating: 4.8 },
            { id: 'm2', name: 'Bretas - Setor Oeste', city: 'Goi√¢nia', distance: '2.1 km', rule: '1 bilhete / R$ 10', has_bonus: false, address: 'Av. Anhanguera, Oeste', rating: 4.5 },
            { id: 'm3', name: 'Supermercado Floresta', city: 'An√°polis', distance: '1.4 km', rule: '1 bilhete / R$ 5', has_bonus: true, bonus_text: 'Sorteio Jundia√≠ Premiado', address: 'Av. Jundia√≠, An√°polis', rating: 4.9 },
            { id: 'm4', name: 'Rio Vermelho - Jaiara', city: 'An√°polis', distance: '3.2 km', rule: '1 bilhete / R$ 7', has_bonus: false, address: 'Vila Jaiara, An√°polis', rating: 4.6 }
        ];

        const App = () => {
            const [step, setStep] = useState('home'); 
            const [isDarkMode, setIsDarkMode] = useState(false);
            const [selectedMerchant, setSelectedMerchant] = useState(null);
            const [isScanning, setIsScanning] = useState(false);
            const [registrationSuccess, setRegistrationSuccess] = useState(null);

            const toggleTheme = () => setIsDarkMode(!isDarkMode);

            const themeClasses = useMemo(() => ({
                bg: isDarkMode ? 'bg-slate-950' : 'bg-gray-50',
                card: isDarkMode ? 'bg-slate-900 border-slate-800' : 'bg-white border-gray-100',
                text: isDarkMode ? 'text-slate-100' : 'text-gray-800',
                textMuted: isDarkMode ? 'text-slate-400' : 'text-gray-500',
                header: isDarkMode ? 'bg-slate-900 border-slate-800' : 'bg-white border-gray-100',
                nav: isDarkMode ? 'bg-slate-900 border-slate-800' : 'bg-white border-gray-100'
            }), [isDarkMode]);

            const Layout = ({ children, title, showBack = false }) => (
                <div className={`flex flex-col h-screen ${themeClasses.bg} ${themeClasses.text} overflow-hidden transition-colors duration-300`}>
                    <header className={`${themeClasses.header} px-6 pt-12 pb-4 flex justify-between items-center border-b shadow-sm z-10 transition-colors`}>
                        <div className="flex items-center gap-2">
                            {showBack && (
                                <button onClick={() => setStep('home')} className={`p-2 -ml-2 ${isDarkMode ? 'text-slate-300' : 'text-gray-600'}`}>
                                    <Icons.ChevronRight className="rotate-180" />
                                </button>
                            )}
                            <h1 className="text-xl font-bold leading-tight">{title}</h1>
                        </div>
                        <div className="flex items-center gap-2">
                            <button onClick={toggleTheme} className={`p-2 rounded-xl transition-all ${isDarkMode ? 'bg-indigo-500/20 text-yellow-400' : 'bg-gray-100 text-gray-500'}`}>
                                {isDarkMode ? <Icons.Sun size={20} /> : <Icons.Moon size={20} />}
                            </button>
                            <button onClick={() => setStep('profile')} className="w-9 h-9 bg-indigo-600 rounded-full flex items-center justify-center text-white font-bold border-2 border-white shadow-sm overflow-hidden">
                                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="avatar" />
                            </button>
                        </div>
                    </header>
                    <main className="flex-1 overflow-y-auto pb-24 transition-all">{children}</main>
                    <nav className={`${themeClasses.nav} fixed bottom-0 left-0 right-0 border-t px-6 py-3 flex justify-between items-center shadow-2xl z-20`}>
                        <button onClick={() => setStep('home')} className={`flex flex-col items-center gap-1 ${step === 'home' ? 'text-indigo-600' : isDarkMode ? 'text-slate-500' : 'text-gray-400'}`}>
                            <Icons.ShoppingBag size={24} /><span className="text-[10px] font-bold uppercase">In√≠cio</span>
                        </button>
                        <button onClick={() => setStep('discovery')} className={`flex flex-col items-center gap-1 ${step === 'discovery' ? 'text-indigo-600' : isDarkMode ? 'text-slate-500' : 'text-gray-400'}`}>
                            <Icons.MapPin size={24} /><span className="text-[10px] font-bold uppercase">Mercados</span>
                        </button>
                        <div className="relative -mt-12">
                            <button onClick={() => setStep('scan')} className="w-16 h-16 bg-indigo-600 rounded-full border-4 border-white dark:border-slate-900 flex items-center justify-center text-white shadow-xl active:scale-90 transition-transform">
                                <Icons.QrCode size={28} />
                            </button>
                        </div>
                        <button onClick={() => setStep('tickets')} className={`flex flex-col items-center gap-1 ${step === 'tickets' ? 'text-indigo-600' : isDarkMode ? 'text-slate-500' : 'text-gray-400'}`}>
                            <Icons.Ticket size={24} /><span className="text-[10px] font-bold uppercase">Bilhetes</span>
                        </button>
                        <button onClick={() => setStep('wallet')} className={`flex flex-col items-center gap-1 ${step === 'wallet' ? 'text-indigo-600' : isDarkMode ? 'text-slate-500' : 'text-gray-400'}`}>
                            <Icons.Wallet size={24} /><span className="text-[10px] font-bold uppercase">Carteira</span>
                        </button>
                    </nav>
                </div>
            );

            // TELA: IN√çCIO
            const HomeScreen = () => (
                <div className="p-6 space-y-6 animate-in fade-in duration-500">
                    <div className="bg-gradient-to-br from-indigo-600 to-indigo-800 rounded-[32px] p-6 text-white shadow-xl relative overflow-hidden">
                        <div className="absolute top-0 right-0 opacity-10 -mr-8 -mt-8 rotate-12"><Icons.Trophy size={180} /></div>
                        <p className="text-indigo-100 text-xs font-bold uppercase tracking-widest">Gastos em Goi√°s (Jan)</p>
                        <h2 className="text-4xl font-black mt-1">R$ 482,35</h2>
                        <div className="flex gap-4 mt-6">
                            <div className="flex-1 bg-white/10 rounded-2xl p-3 backdrop-blur-sm">
                                <p className="text-[10px] text-indigo-100 font-bold uppercase">Seus Bilhetes</p>
                                <p className="text-xl font-black">96</p>
                            </div>
                            <div className={`flex-1 ${isDarkMode ? 'bg-slate-900/40' : 'bg-black/10'} rounded-2xl p-3`}>
                                <p className="text-[10px] text-indigo-100 font-bold uppercase">Sorteio GO</p>
                                <p className="text-xl font-black">24 Dias</p>
                            </div>
                        </div>
                    </div>

                    <div className="space-y-4">
                        <div className="flex justify-between items-center">
                            <h3 className="font-black text-lg">Pr√≥ximos de Voc√™ üìç</h3>
                            <button onClick={() => setStep('discovery')} className="text-indigo-400 text-xs font-bold">Ver Mapa</button>
                        </div>
                        {MOCK_MERCHANTS.slice(0, 2).map(m => (
                            <div key={m.id} onClick={() => { setSelectedMerchant(m); setStep('merchant-detail'); }} className={`p-4 rounded-3xl border flex items-center gap-4 text-left shadow-sm active:scale-[0.98] transition-all cursor-pointer ${themeClasses.card}`}>
                                <div className="w-12 h-12 bg-indigo-600 rounded-2xl flex items-center justify-center text-white">
                                    <Icons.ShoppingBag size={24}/>
                                </div>
                                <div className="flex-1">
                                    <p className="font-bold text-sm leading-tight">{m.name}</p>
                                    <p className="text-[10px] text-gray-400 mt-1">{m.address}</p>
                                    {m.has_bonus && <p className="text-[10px] text-green-500 font-bold mt-1">üî• {m.bonus_text}</p>}
                                </div>
                                <Icons.ChevronRight className="text-gray-300" size={18} />
                            </div>
                        ))}
                    </div>

                    <div className={`${isDarkMode ? 'bg-indigo-500/10' : 'bg-indigo-50'} p-4 rounded-2xl border border-indigo-200/20 flex gap-3 items-center`}>
                        <div className="bg-indigo-600 text-white p-2 rounded-xl"><Icons.Trophy size={18}/></div>
                        <div>
                            <p className="text-xs font-bold">Voc√™ √© destaque em {MOCK_MERCHANTS[0].city}!</p>
                            <p className="text-[10px] opacity-60 italic">Continue comprando para subir no ranking.</p>
                        </div>
                    </div>
                </div>
            );

            // TELA: MERCADOS (DISCOVERY)
            const DiscoveryScreen = () => {
                const cities = ['Goi√¢nia', 'An√°polis'];
                const [filter, setFilter] = useState('Todas');

                const filtered = filter === 'Todas' ? MOCK_MERCHANTS : MOCK_MERCHANTS.filter(m => m.city === filter);

                return (
                    <div className="p-6 space-y-6 animate-in slide-in-from-right-10 duration-500">
                        <div className="flex gap-2 overflow-x-auto pb-2">
                            {['Todas', ...cities].map(c => (
                                <button 
                                    key={c}
                                    onClick={() => setFilter(c)}
                                    className={`px-4 py-2 rounded-full text-xs font-bold whitespace-nowrap transition-all ${filter === c ? 'bg-indigo-600 text-white shadow-lg' : 'bg-white text-gray-400 border border-gray-100'}`}
                                >
                                    {c}
                                </button>
                            ))}
                        </div>

                        <div className="space-y-4">
                            {filtered.map(m => (
                                <div key={m.id} onClick={() => { setSelectedMerchant(m); setStep('merchant-detail'); }} className={`${themeClasses.card} p-4 rounded-3xl border shadow-sm flex items-center gap-4 transition-all active:scale-[0.98]`}>
                                    <div className={`w-14 h-14 rounded-2xl flex items-center justify-center ${m.city === 'Goi√¢nia' ? 'bg-blue-100 text-blue-600' : 'bg-orange-100 text-orange-600'}`}>
                                        <Icons.MapPin size={28}/>
                                    </div>
                                    <div className="flex-1">
                                        <h4 className="font-bold text-sm">{m.name}</h4>
                                        <p className={`text-[10px] flex items-center gap-1 mt-1 ${themeClasses.textMuted}`}>
                                            {m.city} ‚Ä¢ {m.distance} de voc√™
                                        </p>
                                        <div className="flex items-center gap-2 mt-1">
                                            <span className="text-[9px] font-black text-indigo-500 uppercase">{m.rule}</span>
                                        </div>
                                    </div>
                                    <Icons.ChevronRight className="text-gray-300" size={18} />
                                </div>
                            ))}
                        </div>
                    </div>
                );
            };

            // TELA: DETALHE DO MERCADO
            const MerchantDetailScreen = () => (
                <div className="flex flex-col h-full animate-in zoom-in-95 duration-300">
                    <header className="p-8 bg-indigo-600 text-white pt-16 relative rounded-b-[40px] shadow-lg">
                        <button onClick={() => setStep('discovery')} className="absolute top-12 left-6 bg-white/20 p-2 rounded-full backdrop-blur-md">
                            <Icons.ChevronRight className="rotate-180" size={20} />
                        </button>
                        <div className="flex flex-col items-center text-center">
                            <div className="w-20 h-20 bg-white rounded-3xl mb-4 flex items-center justify-center text-indigo-600 shadow-xl">
                                <Icons.ShoppingBag size={40} />
                            </div>
                            <h2 className="text-2xl font-black">{selectedMerchant?.name}</h2>
                            <p className="opacity-80 text-sm mt-1">{selectedMerchant?.address}</p>
                        </div>
                    </header>
                    <div className="p-6 space-y-6">
                        <div className={`p-6 rounded-3xl border ${isDarkMode ? 'bg-slate-900 border-indigo-500/20' : 'bg-indigo-50 border-indigo-100'}`}>
                            <p className="text-xs font-bold text-indigo-400 uppercase tracking-widest">Sua Vantagem</p>
                            <h3 className="text-2xl font-black text-indigo-600 mt-1">{selectedMerchant?.rule}</h3>
                            <p className="text-[10px] opacity-60 mt-4 leading-tight">
                                V√°lido para todas as compras registradas neste estabelecimento em {selectedMerchant?.city}.
                            </p>
                        </div>
                        <button 
                            onClick={() => setStep('scan')} 
                            className="w-full bg-indigo-600 text-white py-5 rounded-[24px] font-black text-lg shadow-xl shadow-indigo-500/30 active:scale-95 transition-transform flex items-center justify-center gap-3"
                        >
                            <Icons.QrCode size={24} /> Registrar Compra
                        </button>
                    </div>
                </div>
            );

            // TELA: BILHETES
            const TicketsScreen = () => (
                <div className="p-6 space-y-6 animate-in slide-in-from-bottom-10 duration-500">
                    <div className={`${themeClasses.card} p-8 rounded-[40px] shadow-sm border text-center`}>
                        <p className={`${themeClasses.textMuted} text-[10px] font-bold uppercase tracking-widest`}>Total de Bilhetes Acumulados</p>
                        <h2 className="text-7xl font-black text-indigo-600 my-4">96</h2>
                        <div className="flex items-center justify-center gap-2 text-green-500 font-bold text-xs">
                             <Icons.CheckCircle size={16} /> Voc√™ j√° concorre ao pr√™mio deste m√™s!
                        </div>
                    </div>

                    <div className="space-y-4">
                        <h3 className="font-black text-lg">Sorteios Ativos em Goi√°s</h3>
                        <div className="bg-slate-900 p-6 rounded-3xl text-white shadow-lg relative overflow-hidden">
                            <div className="absolute top-0 right-0 p-3 bg-indigo-600 rounded-bl-2xl">
                                <Icons.Star size={18} />
                            </div>
                            <p className="text-[10px] font-bold opacity-60 uppercase">Sorteio Mensal - Jan/26</p>
                            <p className="text-2xl font-black text-indigo-400 mt-1">R$ 5.000,00</p>
                            <div className="mt-6 h-2 bg-white/10 rounded-full overflow-hidden">
                                <div className="h-full bg-indigo-500 w-3/4"></div>
                            </div>
                            <div className="flex justify-between mt-2 text-[10px] font-bold opacity-50 uppercase">
                                <span>In√≠cio: 01/01</span>
                                <span>Fim: 31/01</span>
                            </div>
                        </div>
                    </div>
                </div>
            );

            // TELA: CARTEIRA
            const WalletScreen = () => (
                <div className="p-6 space-y-6 animate-in fade-in duration-500">
                    <div className="bg-slate-900 rounded-[40px] p-8 text-white shadow-2xl relative overflow-hidden">
                        <div className="absolute -bottom-10 -right-10 opacity-10"><Icons.Wallet size={200} /></div>
                        <p className="text-slate-400 text-xs font-bold uppercase tracking-widest">Saldo Dispon√≠vel</p>
                        <h2 className="text-5xl font-black mt-2">R$ 50,00</h2>
                        <button className="mt-8 bg-white text-slate-950 px-6 py-3 rounded-2xl font-black text-sm shadow-lg active:scale-95 transition-all flex items-center gap-2">
                            Resgatar via PIX <Icons.ArrowRight size={18} />
                        </button>
                    </div>

                    <div className="space-y-4">
                        <h3 className="font-black text-lg">Hist√≥rico de Pr√™mios</h3>
                        <div className={`${themeClasses.card} p-4 rounded-3xl border flex items-center justify-between`}>
                            <div className="flex items-center gap-3">
                                <div className="bg-yellow-100 text-yellow-600 p-3 rounded-2xl"><Icons.Trophy size={20}/></div>
                                <div>
                                    <p className="font-bold text-sm">Pr√™mio Goi√¢nia Oeste</p>
                                    <p className="text-[10px] opacity-60">Sorteio de Dezembro</p>
                                </div>
                            </div>
                            <p className="font-black text-green-500">R$ 50,00</p>
                        </div>
                    </div>
                </div>
            );

            // TELA: PERFIL
            const ProfileScreen = () => (
                <div className="p-8 space-y-8 animate-in slide-in-from-top-10 duration-500 flex flex-col items-center">
                    <div className="relative">
                        <div className="w-32 h-32 bg-indigo-600 rounded-full flex items-center justify-center text-4xl font-bold text-white shadow-2xl border-4 border-white dark:border-slate-900 overflow-hidden">
                            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="avatar" />
                        </div>
                        <div className="absolute bottom-0 right-0 bg-green-500 w-8 h-8 rounded-full border-4 border-white dark:border-slate-900 flex items-center justify-center text-white">
                            <Icons.CheckCircle size={14} />
                        </div>
                    </div>

                    <div className="text-center">
                        <h2 className="text-2xl font-black">Jo√£o Silva</h2>
                        <p className={themeClasses.textMuted}>joao.silva@goiania.com.br</p>
                        <div className="mt-2 inline-block px-3 py-1 bg-indigo-100 text-indigo-600 rounded-full text-[10px] font-black uppercase">
                            Goi√¢nia - GO
                        </div>
                    </div>

                    <div className="w-full space-y-2">
                        {['Editar Perfil', 'Notifica√ß√µes', 'Central de Ajuda', 'Privacidade'].map(item => (
                            <button key={item} className={`w-full p-4 rounded-2xl border flex justify-between items-center font-bold text-sm ${themeClasses.card} active:bg-indigo-50 transition-all`}>
                                {item} <Icons.ChevronRight size={16} className="text-gray-300" />
                            </button>
                        ))}
                    </div>

                    <div className="w-full pt-8 border-t border-gray-100 dark:border-slate-800 text-center">
                        <p className="text-[10px] font-bold opacity-30 uppercase tracking-widest mb-1">MercadoF√£ v{APP_VERSION}</p>
                        <p className="text-xs font-black text-indigo-600 opacity-30">DESENVOLVIDO PARA GOI√ÅS</p>
                    </div>
                </div>
            );

            // SCANNER (SIMULA√á√ÉO)
            const ScanScreen = () => {
                const handleSimulate = () => {
                    setIsScanning(true);
                    setTimeout(() => {
                        setIsScanning(false);
                        setRegistrationSuccess({ merchant: selectedMerchant?.name || 'Mercado Parceiro', tickets: 24 });
                    }, 1500);
                };

                if (registrationSuccess) return (
                    <div className={`flex flex-col h-screen items-center justify-center p-6 text-center ${isDarkMode ? 'bg-slate-950 text-white' : 'bg-white'}`}>
                        <div className="w-24 h-24 bg-green-100/20 text-green-500 rounded-full flex items-center justify-center mb-6 scale-up-animation">
                            <Icons.CheckCircle size={60} />
                        </div>
                        <h2 className="text-2xl font-black">Compra Registrada!</h2>
                        <p className="opacity-60 mt-2 mb-8 px-8">Seu cupom no <b>{registrationSuccess.merchant}</b> foi validado com sucesso.</p>
                        <div className="bg-indigo-600 text-white p-8 rounded-[48px] w-full shadow-2xl shadow-indigo-500/30">
                            <p className="text-xs uppercase opacity-60 font-black mb-2 tracking-widest">Voc√™ Ganhou</p>
                            <p className="text-7xl font-black">{registrationSuccess.tickets}</p>
                            <p className="text-[10px] mt-4 opacity-50 uppercase font-bold">Bilhetes da Sorte</p>
                        </div>
                        <button onClick={() => { setRegistrationSuccess(null); setStep('home'); }} className="w-full bg-indigo-600 text-white py-5 rounded-[24px] font-black mt-8 shadow-lg active:scale-95 transition-transform">Voltar ao In√≠cio</button>
                    </div>
                );

                return (
                    <div className="bg-black h-screen flex flex-col items-center justify-center p-8">
                        <button onClick={() => setStep('home')} className="absolute top-12 left-6 text-white p-2 bg-white/10 rounded-full backdrop-blur-md">
                            <Icons.ChevronRight className="rotate-180" size={24} />
                        </button>
                        <div className="w-full aspect-square border-2 border-indigo-500/50 rounded-[56px] relative overflow-hidden flex items-center justify-center bg-indigo-900/10">
                            <div className="animate-scan"></div>
                            {isScanning ? (
                                <div className="text-center">
                                    <div className="w-12 h-12 border-4 border-t-indigo-500 border-white/10 rounded-full animate-spin mx-auto mb-4"></div>
                                    <p className="text-indigo-400 font-black text-[10px] uppercase tracking-widest">Validando Cupom...</p>
                                </div>
                            ) : (
                                <Icons.QrCode size={140} className="text-white/10" />
                            )}
                        </div>
                        <div className="text-center mt-12 space-y-2">
                            <p className="text-white font-black text-xs uppercase tracking-widest">Escaneie o QR Code</p>
                            <p className="text-white/40 text-[10px] px-10">Mantenha o c√≥digo da nota fiscal no centro do visor.</p>
                        </div>
                        <button onClick={handleSimulate} className="mt-12 bg-white text-black py-4 px-12 rounded-full font-black shadow-xl active:scale-95 transition-transform">Simular Leitura</button>
                    </div>
                );
            };

            const renderScreen = () => {
                switch (step) {
                    case 'home': return <Layout title="MercadoF√£"><HomeScreen /></Layout>;
                    case 'discovery': return <Layout title="Encontrar Mercados" showBack><DiscoveryScreen /></Layout>;
                    case 'merchant-detail': return <MerchantDetailScreen />;
                    case 'scan': return <ScanScreen />;
                    case 'tickets': return <Layout title="Meus Bilhetes" showBack><TicketsScreen /></Layout>;
                    case 'wallet': return <Layout title="Minha Carteira" showBack><WalletScreen /></Layout>;
                    case 'profile': return <Layout title="Meu Perfil" showBack><ProfileScreen /></Layout>;
                    default: return <HomeScreen />;
                }
            };

            return (
                <div className={`max-w-md mx-auto min-h-screen shadow-2xl transition-all duration-300 relative ${themeClasses.bg}`}>
                    {renderScreen()}
                </div>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
